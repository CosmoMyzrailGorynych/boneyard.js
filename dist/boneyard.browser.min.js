var boneyard=function(){"use strict";var e;var t="undefined"==typeof document?void 0:document,n=!!t&&"content"in t.createElement("template"),r=!!t&&t.createRange&&"createContextualFragment"in t.createRange();function a(a){return a=a.trim(),n?function(e){var n=t.createElement("template");return n.innerHTML=e,n.content.childNodes[0]}(a):r?function(n){return e||(e=t.createRange()).selectNode(t.body),e.createContextualFragment(n).childNodes[0]}(a):function(e){var n=t.createElement("body");return n.innerHTML=e,n.childNodes[0]}(a)}function i(e,t){var n,r,a=e.nodeName,i=t.nodeName;return a===i||(n=a.charCodeAt(0),r=i.charCodeAt(0),n<=90&&r>=97?a===i.toUpperCase():r<=90&&n>=97&&i===a.toUpperCase())}function o(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var l={OPTION:function(e,t){var n=e.parentNode;if(n){var r=n.nodeName.toUpperCase();"OPTGROUP"===r&&(r=(n=n.parentNode)&&n.nodeName.toUpperCase()),"SELECT"!==r||n.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),n.selectedIndex=-1)}o(e,t,"selected")},INPUT:function(e,t){o(e,t,"checked"),o(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var r=e.firstChild;if(r){var a=r.nodeValue;if(a==n||!n&&a==e.placeholder)return;r.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n,r,a=-1,i=0,o=e.firstChild;o;)if("OPTGROUP"===(r=o.nodeName&&o.nodeName.toUpperCase()))o=(n=o).firstChild;else{if("OPTION"===r){if(o.hasAttribute("selected")){a=i;break}i++}!(o=o.nextSibling)&&n&&(o=n.nextSibling,n=null)}e.selectedIndex=a}}};function d(){}function c(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}var u=function(e){return function(n,r,o){if(o||(o={}),"string"==typeof r)if("#document"===n.nodeName||"HTML"===n.nodeName||"BODY"===n.nodeName){var u=r;(r=t.createElement("html")).innerHTML=u}else r=a(r);var s=o.getNodeKey||c,f=o.onBeforeNodeAdded||d,h=o.onNodeAdded||d,p=o.onBeforeElUpdated||d,m=o.onElUpdated||d,g=o.onBeforeNodeDiscarded||d,v=o.onNodeDiscarded||d,b=o.onBeforeElChildrenUpdated||d,N=!0===o.childrenOnly,y=Object.create(null),A=[];function $(e){A.push(e)}function x(e,t){if(1===e.nodeType)for(var n=e.firstChild;n;){var r=void 0;t&&(r=s(n))?$(r):(v(n),n.firstChild&&x(n,t)),n=n.nextSibling}}function w(e,t,n){!1!==g(e)&&(t&&t.removeChild(e),v(e),x(e,n))}function C(e){h(e);for(var t=e.firstChild;t;){var n=t.nextSibling,r=s(t);if(r){var a=y[r];a&&i(t,a)?(t.parentNode.replaceChild(a,t),E(a,t)):C(t)}else C(t);t=n}}function E(n,r,a){var o=s(r);if(o&&delete y[o],!a){if(!1===p(n,r))return;if(e(n,r),m(n),!1===b(n,r))return}"TEXTAREA"!==n.nodeName?function(e,n){var r,a,o,d,c,u=n.firstChild,h=e.firstChild;e:for(;u;){for(d=u.nextSibling,r=s(u);h;){if(o=h.nextSibling,u.isSameNode&&u.isSameNode(h)){u=d,h=o;continue e}a=s(h);var p=h.nodeType,m=void 0;if(p===u.nodeType&&(1===p?(r?r!==a&&((c=y[r])?o===c?m=!1:(e.insertBefore(c,h),a?$(a):w(h,e,!0),h=c):m=!1):a&&(m=!1),(m=!1!==m&&i(h,u))&&E(h,u)):3!==p&&8!=p||(m=!0,h.nodeValue!==u.nodeValue&&(h.nodeValue=u.nodeValue))),m){u=d,h=o;continue e}a?$(a):w(h,e,!0),h=o}if(r&&(c=y[r])&&i(c,u))e.appendChild(c),E(c,u);else{var g=f(u);!1!==g&&(g&&(u=g),u.actualize&&(u=u.actualize(e.ownerDocument||t)),e.appendChild(u),C(u))}u=d,h=o}!function(e,t,n){for(;t;){var r=t.nextSibling;(n=s(t))?$(n):w(t,e,!0),t=r}}(e,h,a);var v=l[e.nodeName];v&&v(e,n)}(n,r):l.TEXTAREA(n,r)}!function e(t){if(1===t.nodeType||11===t.nodeType)for(var n=t.firstChild;n;){var r=s(n);r&&(y[r]=n),e(n),n=n.nextSibling}}(n);var T,S,U=n,O=U.nodeType,L=r.nodeType;if(!N)if(1===O)1===L?i(n,r)||(v(n),U=function(e,t){for(var n=e.firstChild;n;){var r=n.nextSibling;t.appendChild(n),n=r}return t}(n,(T=r.nodeName,(S=r.namespaceURI)&&"http://www.w3.org/1999/xhtml"!==S?t.createElementNS(S,T):t.createElement(T)))):U=r;else if(3===O||8===O){if(L===O)return U.nodeValue!==r.nodeValue&&(U.nodeValue=r.nodeValue),U;U=r}if(U===r)v(n);else{if(r.isSameNode&&r.isSameNode(U))return;if(E(U,r,N),A)for(var R=0,k=A.length;R<k;R++){var V=y[A[R]];V&&w(V,V.parentNode,!1)}}return!N&&U!==n&&n.parentNode&&(U.actualize&&(U=U.actualize(n.ownerDocument||t)),n.parentNode.replaceChild(U,n)),U}}((function(e,t){var n,r,a,i,o=t.attributes;if(11!==t.nodeType&&11!==e.nodeType){for(var l=o.length-1;l>=0;l--)r=(n=o[l]).name,a=n.namespaceURI,i=n.value,a?(r=n.localName||r,e.getAttributeNS(a,r)!==i&&("xmlns"===n.prefix&&(r=n.name),e.setAttributeNS(a,r,i))):e.getAttribute(r)!==i&&e.setAttribute(r,i);for(var d=e.attributes,c=d.length-1;c>=0;c--)r=(n=d[c]).name,(a=n.namespaceURI)?(r=n.localName||r,t.hasAttributeNS(a,r)||e.removeAttributeNS(a,r)):t.hasAttribute(r)||e.removeAttribute(r)}}));const s=/^(?<tagName>[\w-]+)?(?<ids>(?:[\.#][\w-]+)*)(?:\((?<attrs>[^\n]*?)\))?(?:\s(?<text>[\s\S]+)?)?$/,f=/(\.[\w-]+)/g,h=/(#[\w-]+)/g,p=/^\s*/,m=/^((if|while|for)\s*\([\s\S]+\)|else)$/,g=["br","img","hr","area","base","col","command","embed","input","link","meta","keygen","param","source","track","wbr"],v=e=>{const t=e.split(/\r?\n/g),n={type:"root",children:[]},r=[-1],a=[];let i=n,o=n;for(let e=0;e<t.length;e++){const n=t[e],u=n.trim();if(""===u)continue;const f=r[r.length-1],h=(c=n,p.exec(c)[0].length);let m;if("|"===u[0])m={type:"text",value:u.slice(1).trimStart()};else if(u.startsWith("//"))"-"===u[2]&&(m={type:"comment",value:u.slice(3)});else if("-"===u[0])m={type:"code",value:u.slice(1).trim(),children:[]};else{const t=s.exec(u);if(!t)throw new Error(`Line ${e+1}: malformed tag.\n${u}`);const{tagName:n,ids:r,attrs:a,text:i}=t.groups;if(m={type:"tag",tagName:n||"div",ids:r,attrs:a,hasText:Boolean(i),children:[],atomic:g.includes(n)},i){if(m.atomic)throw new Error(`Line ${e+1}: tag ${n} cannot have a text node.\n${u}`);m.children.push({type:"text",value:i.trim()})}}if(h<f){if(-1===r.indexOf(h))throw new Error(`Bad indentation at line ${e+1}, expected depth: ${r.join(", ")} spaces, got ${h}.\n${n}`);for(;r[r.length-1]!==h;)a.pop(),r.pop(),i=a[a.length-1];i.children.push(m)}else if(h>f){if(!("children"in i))throw new Error(`Line ${e+1}: entry of type ${i.type} cannot have children.\n${n}`);if("tag"===i.type){if(g.includes(i.tagName))throw new Error(`Line ${e+1}: tag ${i.tagName} cannot have children.\n${n}`);if(i.hasText)throw new Error(`Line ${e+1}: tag ${i.tagName} has a text node and cannot have children.\n${n}`)}l=o,d=h,r.push(d),a.push(l),i=l,i.children.push(m)}else i.children.push(m);o=m}var l,d,c;return n},b=/'/g,N=e=>e.replace(b,"\\`");let y;const A=e=>{let t="";return y&&!e?t="`;":!y&&e&&(t="html+=`"),y=e,t},$=e=>{if(e instanceof Array)return e.map($).join("");let t;switch(e.type){case"comment":return`${A(!0)}\x3c!--${N(e.value)}--\x3e`;case"code":t=A(!1)+e.value;const n=m.test(e.value);return n&&(t+="{"),e.children?.length&&(t+=$(e.children)),n&&(t+=`${A(!1)}}`),y=!1,t;case"text":return`${A(!0)}${N(e.value)}`;case"tag":const r=e.atomic;let a=e.attrs?" "+e.attrs:"";return e.ids&&(a+=(e=>{const t=h.exec(e)?.[0],n=e.match(f);let r="";if(t&&(r+=` id="${t.slice(1)}" `),n?.length){r+=' class="';for(const e of n)r+=e.slice(1)+" ";r=r.slice(0,-1)+'" '}return r.slice(0,-1)})(e.ids)),t=`${A(!0)}<${e.tagName}${N(a)}${r?"/":""}>`,e.children?.length&&(t+=$(e.children)),r||(t+=`${A(!0)}</${e.tagName}>`),y=!0,t}},x=e=>{try{return new Function("state",e)}catch(t){throw console.error(e),new Error(`Malformed JS code: ${t.message}`)}},w=e=>{let t="let html = '';";return y=!1,t+=$(e.children),y&&(t+="`;"),t+="return html;",t};var C={render(e,t={}){const n=v(e),r=w(n);return x(r)(t)},renderer:e=>x(w(v(e)))};const E=(e,t,n,r)=>{e.addEventListener(n,(e=>{const n=e.target.closest(t);n&&r.apply(n,[e])}))},T=(e,t,n={},r)=>{const a=C.renderer(e),i=()=>{r&&r(n),u(t,`<div>${a(n)}</div>`,{childrenOnly:!0})},o=e=>t=>{const r=t.target.getAttribute(e);if(!(r in n))throw console.warn("[boneyard.js] Dumping current state:",n),new Error(`[boneyard.js] Missing event "${r}".`);n[r](t,n),i()},l=e=>t=>{const r=t.target.getAttribute(e),a=["checkbox","radio"].includes(t.target.getAttribute("type")),o=a&&["number","slider"].includes(t.target.getAttribute("type"));let l=a?t.target.checked:t.target.value;o&&(l=Number(l)),((e="",t,n)=>{const r=e.split(/(?<!\\)\./gi);for(;r.length>1;)if("object"!=typeof(t=t[r.shift()])&&r.length>1)return;t[r[0]]=n})(r,n,l),i()};return E(t,"[data-onclick]","click",o("data-onclick")),E(t,"[data-onfocus]","focus",o("data-onfocus")),E(t,"[data-onblur]","blur",o("data-onblur")),E(t,"[data-oninput]","input",o("data-oninput")),E(t,"[data-onchange]","change",o("data-onchange")),E(t,"[data-bindinput]","input",l("data-bindinput")),E(t,"[data-bindchange]","change",l("data-bindchange")),i(),i};return{async mount(e,t,n={},r){const a=await fetch(e).then((e=>e.text()));return T(a,t,n,r)},mountMeat:T}}();
